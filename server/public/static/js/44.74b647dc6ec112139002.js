webpackJsonp([44],{c54Q:function(t,e){},kZXB:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("Dd8w"),a=o.n(n),s=o("NYxO"),l={data:function(){return{form:{address:"",type:0,currency:0},rules:{address:[{validator:function(t,e,o){void 0!==e&&""!==e||o(new Error("必填")),e.startsWith("0x")&&42===e.length||o(new Error("请输入正确的合约地址")),o()}}],type:[{validator:function(t,e,o){void 0!==e&&""!==e||o(new Error("必填")),o()}}]},isUpload:!1,list:[],tokenInfo:{isTest:0,tokenId:0,tokenSymbol:"",contractAddr:""},dataCount:0,uniqueCount:0,wrongCount:0,totalAmount:0,options:[{value:0,label:"ERC20"},{value:1,label:"ETH"}]}},methods:a()({},Object(s.b)(["addUserDispenseAsset","getTokenInfo"]),{handleBefore:function(t){if(!this.tokenInfo.tokenId)return alert("请填写合约地址"),!1},handleSuccess:function(t){console.log("success"),0===t.errcode&&(this.isUpload=!0,this.list=t.data.dataList,this.dataCount=t.data.dataCount,this.totalAmount=t.data.totalAmount,this.wrongCount=t.data.wrongCount)},handleError:function(t){this.$message.error("上传失败，请重试")},submit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.isUpload=!0})},fetch:function(){console.log("download"),downloadFile("/static/file/sample.xls")},getToken:function(){var t=this;this.tokenInfo.contractAddr&&this.getTokenInfo({contractAddr:this.tokenInfo.contractAddr}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.tokenInfo.tokenId=e.tokenId,t.tokenInfo.tokenSymbol=e.tokenSymbol})},confirm:function(){var t=this;this.addUserDispenseAsset({tokenId:this.tokenInfo.tokenId}).then(function(){t.$emit("finished",{tokenId:t.tokenInfo.tokenId,totalAmount:t.totalAmount,totalCount:t.dataCount-t.wrongCount})})}})},r={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"step1"},[t.isUpload?o("div",[o("h4",[t._v("上传成功")]),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,height:"400"}},[o("el-table-column",{attrs:{type:"index"}}),t._v(" "),o("el-table-column",{attrs:{prop:"address",width:"400",label:"地址"}}),t._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),t._v(" "),o("el-table-column",{attrs:{prop:"status",label:"状态"}})],1),t._v(" "),o("footer",{staticClass:"footer"},[o("el-row",[o("el-col",{attrs:{span:5}},[o("h5",[t._v("总数量")]),t._v(" "),o("div",[t._v("\n            "+t._s(t.totalAmount)+"\n            "),o("small",[t._v("枚")])])]),t._v(" "),o("el-col",{attrs:{span:5}},[o("h5",[t._v("总地址")]),t._v(" "),o("div",[t._v("\n            "+t._s(t.dataCount)+"\n            "),o("small",[t._v("条")])])]),t._v(" "),o("el-col",{attrs:{span:5}},[o("h5",[t._v("错误数据")]),t._v(" "),o("div",[t._v("\n            "+t._s(t.wrongCount)+"\n            "),o("small",[t._v("条")])])]),t._v(" "),o("el-col",{staticClass:"text-center",attrs:{span:9}},[o("el-button",{staticClass:"btn-primary",attrs:{type:"warning"},on:{click:t.confirm}},[t._v("确定")]),t._v(" "),o("el-upload",{staticClass:"upload-btn",attrs:{name:"addr",action:"/api/parseAddrFile",data:t.tokenInfo,"before-upload":t.handleBefore,"on-success":t.handleSuccess,"on-error":t.handleError,"show-file-list":!1}},[o("el-button",{staticClass:"text-primary",attrs:{type:"text"}},[t._v("重新上传")])],1)],1)],1)],1)],1):o("el-form",{ref:"form",staticClass:"form",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"",prop:"type"}},[o("el-radio-group",{model:{value:t.tokenInfo.isTest,callback:function(e){t.$set(t.tokenInfo,"isTest",e)},expression:"tokenInfo.isTest"}},[o("el-radio",{attrs:{label:0}},[t._v("正式发放")]),t._v(" "),o("el-radio",{attrs:{label:1}},[t._v("测试发放"),o("small",{staticStyle:{color:"#ccc"}},[t._v("（测试时仅向前两个地址发放代币）")])])],1)],1),t._v(" "),o("el-form-item",{staticClass:"step1-input-group",attrs:{label:"发放类别",prop:"currency"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.currency,callback:function(e){t.$set(t.form,"currency",e)},expression:"form.currency"}},t._l(t.options,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),1!==t.form.currency?o("el-input",{staticClass:"step1-input",attrs:{placeholder:"请输入合约地址"},on:{blur:t.getToken},model:{value:t.tokenInfo.contractAddr,callback:function(e){t.$set(t.tokenInfo,"contractAddr",e)},expression:"tokenInfo.contractAddr"}},[o("i",{attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(t.tokenInfo.tokenSymbol))])]):t._e()],1),t._v(" "),o("el-form-item",{attrs:{label:"上传地址"}},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"请输入合约地址",disabled:!!t.tokenInfo.tokenId,placement:"bottom"}},[o("el-upload",{staticClass:"upload-btn",attrs:{name:"addr",action:"/api/parseAddrFile","before-upload":t.handleBefore,"on-success":t.handleSuccess,"on-error":t.handleError,data:t.tokenInfo,disabled:!t.tokenInfo.tokenId,"show-file-list":!1}},[o("el-button",{staticClass:"btn-primary",attrs:{slot:"trigger",type:"warning"},slot:"trigger"},[t._v("点击上传")])],1)],1),t._v(" "),o("el-button",{attrs:{type:"warning",plain:""},on:{click:t.fetch}},[t._v("获取模板")])],1)],1)],1)},staticRenderFns:[]};var i=o("VU/8")(l,r,!1,function(t){o("c54Q")},null,null);e.default=i.exports}});
//# sourceMappingURL=44.74b647dc6ec112139002.js.map